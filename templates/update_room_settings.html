{% extends 'base.html' %}

{% block pagebody %}
<div class="container">
  {% if get_flashed_messages(category_filter=('error')) %}
    <div class="card bg-light shadow" style="width: 30rem; height: 32rem; margin: auto; margin-top: 1%; border: hidden;">
  {% else %}
    <div class="card bg-light shadow" style="width: 30rem; height: 36rem; margin: auto; margin-top: 2%; border: hidden;">
  {% endif %}
    <div class="card-body">
      <div class="container text-center" style="margin-top: 1rem; margin-bottom: 1rem;">
        <h3 class="card-title">Room Settings</h3>
        <form action="{{url_for('room_settings_form')}}" method="POST" class="text-center">
          {% for room in rooms %}
            {{room.name}}
            <input name={{room.id}} type="number" style="width: 250px;" value="{{ room.max_capacity }}">
            <br>
            <div style="display: inline;">
              <form action="{{url_for('del_room', room_id = room.id)}}" method="POST">
                <input type="submit" value="Delete" class="btn btn-danger btn-sm my-2">
              </form>
            </div>
          {% endfor %}
          <div>
            <form action="{{url_for('add_room_')}}">
              <input type="submit" value="Add Room" class="btn btn-danger">
            </form>
          </div>
          <input type="submit" class="btn btn-info text-light text-center mb-2" value="Update"> <!--TODO THIS INPUT DOESN'T WORK-->
        </form>
      </div>
    </div>
  </div>

  <div class="mt-4">
    <form action="{{url_for('settings')}}">
      <input type="submit", value="Back" class="btn btn-info text-light">
    </form>
  </div>
</div>

<script>
  
  function del_room(r_id) {
    var r = confirm("If you Confirm all shifts and prenotations in this room will be deleted and also all program course for this room");
    if (r == true) {
      post(path="{{url_for('del_room', room_id = r_id)}}")
    }
    else {
      window.location.href = "{{url_for('room_settings')}}"
    }
  }

  function post(path, params, method='post') {

    // The rest of this code assumes you are not using a library.
    // It can be made less verbose if you use one.
    const form = document.createElement('form');
    form.method = method;
    form.action = path;

    for (const key in params) {
      if (params.hasOwnProperty(key)) {
        const hiddenField = document.createElement('input');
        hiddenField.type = 'hidden';
        hiddenField.name = key;
        hiddenField.value = params[key];

        form.appendChild(hiddenField);
      }
    }
    document.body.appendChild(form);
    form.submit();
    }
  
</script>


{% endblock %}