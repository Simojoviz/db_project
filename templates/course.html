{% extends 'base.html' %}

{% block pagebody %}

<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
.collapsible {
  background-color: rgb(13, 202, 240);
  color: white;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  border: none;
  text-align: left;
  outline: none;
  font-size: 15px;
}

.active, .collapsible:hover {
  background-color: rgb(13, 202, 240);
}

.content {
  padding: 0 18px;
  display: none;
  overflow: hidden;
  background-color: #f1f1f1;
}
</style>

<div class="container"> 
  <h1 class="display-3 text-center">{{course.name}}</h1>
  <div class="card bg-light shadow p-3 mb-5 mt-4 mx-auto w-75" style="border: hidden;">
    <h3>Course Informations</h3>
    <table class="table table-borderless ml-3">
      <tr>
        <td><strong>Starting</strong></td>
        <td>{{course.starting}}</td>
      </tr>
      <tr>
        <td><strong>Ending</strong></td>
        <td>{{course.ending}}</td>
      </tr>
      <tr>
        <td><strong>Trainer</strong></td>
        <td>{{course.trainer.user.fullname}}</td>
      </tr>
      <tr>
        <td><strong>Days</strong></td>
        <td>
          {% for i in course_program %}
            {{i.week_day}} - {{i.room.name}} 
            <br>
          {% endfor %}
        </td>
      </tr>
      <tr>
        <td><strong>Shifts</strong></td>
        <td>
          {% for i in shift %}
            {{i.h_start}} - {{i.h_end}} 
            <br>
          {% endfor %}
        </td>
      </tr>
      <tr>
        <td><strong>Slots Available</strong></td>
        <td>{{course.max_partecipants - course.users|length}}/{{course.max_partecipants}}</td>
      </tr>
    </table>
    {% if "Admin" not in current_user.roles  %}
      {% if current_user.is_authenticated %}
        {% if course_sign_up.course_id != course.id %}
          <form action= "{{ url_for('sign_up', course_name = course.name) }}">
            <input type="submit" value="Subscribe" class="btn btn-success">
          </form>
        {% else %}
          <form action="{{ url_for('delete_sign_up', course_name = course.name)}}">
            <input type="submit", value="Unsubscribe" class="btn btn-danger">
          </form>
        {% endif %}
      {% else %}
        <form action= "{{ url_for('sign_up', course_name = course.name) }}">
          <input type="submit", value="Subscribe" class="btn btn-success">
        </form>
      {% endif %}
    {% else %}
      <button type="button" class="collapsible">Signs-Up</button>
      <div class="content">
        {% for u in course.users %}
          {{u.fullname}} <br>
        {% endfor %}
      </div>
    {% endif %}
  </div>

  <div class="mt-4">
    <form action="{{url_for('courses')}}">
      <input type="submit", value="Back" class="btn btn-info text-light">
    </form>
  </div>

</div>

<script>
  var coll = document.getElementsByClassName("collapsible");
  var i;
  
  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var content = this.nextElementSibling;
      if (content.style.display === "block") {
        content.style.display = "none";
      } else {
        content.style.display = "block";
      }
    });
  }
</script>
{% endblock %}